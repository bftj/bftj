<!DOCTYPE html>
<html>
  <head>
    <meta charset=utf-8 />
    <title>Slides – Sagaen om Harald Blåtann</title>
    <script src=js/remark-0.10.2.min.js></script>
    <link rel=stylesheet type=text/css href=css/style.css />
  </head>
  <body>
    <textarea id="source">

class: center, middle

## Sagaen om Harald Blåtann <span class=subtle>med bftj</span>

### http://bftj.co

---
class: center, middle

## Hvem er vi?

???

- Dette kurset vil bli filmet, hvis noen ikke vil være med på filmen, si i fra så skal vi anonymisere deg
  - Filmen er for vår egen del, vi ønsker å lære mer og bli bedre på kurs
- Først og fremst takk til fagkom for muffins og kaffe
- 4.-5. klasse data@NTNU
- Blåtannfrelste personligheter
- Laget et open source blåtannbibliotek for mbed i forbindelse med sommerjobb hos Nordic Semiconductor

---
class: center, middle, hb

## Hvem var Harald Blåtann?

???

- Konge av Danmark(~958-986) og Norge(~970-975/986)
- Samlet alle Danske stammer til ett forent rike og introduserte kristendom
- Opphavet til navnet Bluetooth da denne teknologien skal samle alle kommunikasjonsprotokoller til én standard

---
class: center, middle

# Hvorfor 'Blåtann'?

???

- Sagnene sier at Harald hadde en død tann og at dette er grunnen til navnet
- MEN! **// bytt slide**

---
class: center, middle, hb-info

???

- Dette bildet vi fant på internett sier helt klart og tydlig at `tand er et gammelt ord for høvding`
- Det sier også at `blå betød sort på den tida`
- Dermed kan det bety at hans navn egentlig var `den mørke høvdingen`
- **// Kunsterisk pause til stående applaus**

---
class: center, middle

# Dette kurset

## 3 timer

* Blåtann
* mbed
* Hjelpemidler

## 3 oppgaver

Lag en mbed med blåtann  
Chat fra telefonen til mbed-en  
Something, something, third task

???

- Vi holder korte foredrag om teknologi fulgt av oppgaver
- Under oppgavene går vi rundt og hjelper til, rekk opp hånda om dere trenger hjelp
- Vi tar ca et kvarters pause mellom hver oppgave

---
class: center

# http://bftj.co

![](/images/bftjco.png)

???

- Vi har en nettside, som inneholder **guider**, **oppgavene**, **slides** osv
- Bruk denne som ressurs når du jobber
- Denne er tilgjengelig også etter kurset så den kan brukes om du trenger hjelp senere

---
class: full-image

<div class=bg style=background-image:url(http://i.imgur.com/ESUO88n.png)>
  <h1 style=padding:0;margin:0;padding-top:1em;text-align:center>
    Bluetooth Low Energy
  </h1>
</div>

???

Kjært barn har mange navn (1/4)

---
class: full-image

<div class=bg style=background-image:url(http://i.imgur.com/ESUO88n.png)>
  <h1 style=padding:0;margin:0;padding-top:1em;text-align:center>
    Bluetooth Smart
  </h1>
</div>

???

Kjært barn har mange navn (2/4)

---
class: full-image

<div class=bg style=background-image:url(http://i.imgur.com/ESUO88n.png)>
  <h1 style=padding:0;margin:0;padding-top:1em;text-align:center>
    Bluetooth 4.0
  </h1>
</div>

???

Kjært barn har mange navn (3/4)

---
class: full-image

<div class=bg style=background-image:url(http://i.imgur.com/ESUO88n.png)>
  <h1 style=padding:0;margin:0;padding-top:1em;text-align:center>
    BLE
  </h1>
</div>

???

Kjært barn har mange navn (4/4)

---
class: full-image
<div class=bg style=background-image:url(http://i.imgur.com/qA5CTbm.jpg)>
</div>

???

- Bluetooth er en protokoll for kommunikasjon mellom enheter
- Kort rekkevidde på kommunikasjonen
- Starter med å annonsere at den finnes -> med info som navn, adresse og liknende
- Når noen kopler seg til forteller den hva den kan tilby (hvilke services den har)
- D2D == "device to device"
- trådløs på samme frekvenser som wifi, altså 2.4Ghz

---

class: full-image
<div class=bg style=background-image:url(http://i.imgur.com/SUOxuUi.png)>
</div>
 
??? 

- Example of what is possible with BLE
- Neo smart jar
- "The worlds first smart jar"


---
class: full-image
<div class=bg style=background-image:url(http://i.imgur.com/h3GRHnC.jpg)>
</div>
 
??? 

- Example of what is possible with BLE
- "Tile is the smart companion for all the things you can't stand to lose."
- aldri mist noe igjen

---

class: full-image
<div class=bg style=background-image:url(http://i.imgur.com/udn6yQH.jpg)>
</div>
 
??? 

- Example of what is possible with BLE
- moto360
- smartwatches
- apple watch

---
class: full-image

<div class=bg style=background-image:url(http://i.imgur.com/RGr7XEj.png)></div>

???

- IBeacon
- BLE-basert
- Passiv
- Innendørs lokasjon, kontekst
- Apple, Android, etc, ..

---
class: full-image

<div class=bg style=background-image:url(http://i.imgur.com/A8mSBD7.jpg)></div>

???

- Et eksempel: Estimote.
- Få tilbud på telefonen når du er i butikken

---

class: full-image
<div class=bg style=background-image:url(http://i.imgur.com/ViT63Zx.png)></div>

???

- Slik ser den ut inni
- egentlig bare en slik *holde opp en mbed* pakket inn i et pent skall
- fun fact: man kan lage en slik i dette kurset med bare 3 (?) linjer med kode
- se hvor liten den egentlig er, lett å tro at den er stor på bildet i forrige slide

---

class: full-image
<div class=bg style=background-image:url(http://i.imgur.com/bsonCv4.png)></div>

???

- IBeacon er en del av Internet of Things, og BLE er katalysatoren som får Internet of Things til å skje

---
class: center, middle

# mbed

Lavterskeltilbud til lavnivåprogrammering  

Utviklingsmiljøet i nettleseren  

Drag & drop-installering

???

- Plug mbed-en i PC-en og den likner på en USB
- Man utvikler og skriver kode i nettleseren med dokumentasjon og liknende
- Trykker på en knapp i nettleseren for å laste ned en fil med koden din
- Dra denne filen over til mbed-en for å installere kode på mbeden

- Takk til Nordic for donasjon av mbedsene dere ser her. Hver gruppe skal få med seg en hjem til odel og eie.

---
class: center, middle

# C++

Utviklingsspråket til mbed  

Høynivåspråk i embedded-verden

???

- (Håndsopprekning) Hvor mange har jobba i C++ før?
- Som om C og Java hadde et barn

- C++ gir oss klasser og andre hjelpmidler når vi utvikler
- Finnes mange bra bibliotek og andre ressurser
- De som trenger en kjapp gjennomgang av hvordan ting gjøres kan se på guiden vår på sida

---
class: center, middle

# Puck-biblioteket

Open source  

Skrevet av oss  

Enkelt

???

- Fullt open source-bibliotek alle kan bidra til og jobbe med
- Laget av oss i sommer for Nordic
- Abstraherer bort mye av kompleksiteten til Blåtann

---
class: center, middle

# En rask gjennongang av hvordan man jobber på mbed

???

- Skriv noe kode i compileren
- Last ned `.hex`-filen
- Last over på mbed-en
- Trykk på reset

- Fortell hva du gjør mens du gjør det

---
class: center, middle

# Oppgave 1

## Koble til mbed

### http://bftj.co

???

- Oppgaven ligger på http://bftj.co
- Dere skal lage en Blåtannenhet som kan koples til og fra ved hjelp av mbed og Puck-biblioteket
- Dere har ~30 min på dere og vi går rundt

---
class: center, middle

# SPOILER ALERT

Løsningsforslag for oppgave 1 følger

---
class: center, middle

# LF oppgave 1

```cpp

#define LOG_LEVEL_INFO
#include "Puck.h"

Puck* puck = &Puck::getPuck();

int main(void) {

  // Initialize the puck
  puck->init(0xFEED);

  // Let the puck do its thing
  while(puck->drive());
}
```

???

- Så enkelt er det!
- Du vil nå kunne finne mbeden (pucken som vi kaller det) i Blåtann-appene dine

---
class: center, middle

# Blåtann LE Primer

---
class: center

# Blåtann LE Primer

### Energieffektiv over korte avstander
### Reklamerer jevnlig for dens "services"
### "services" tilbys etter tilkobling
### Pauser så reklamering til koblingen avslutter

???

Reklamen inneholder ting som
- navn
- adresse
- UUIDer på tjenester og karakteristikker

---
class: center

# Blåtann LE-paradigmet

<img alt="One does not simply open a BLE socket and start pumping data" src=/images/ble-guide-simply.jpg style="width: auto">

???

For å oppnå lavt energibruk, og en effektiv og tilpasset protokoll er det masse rare konsepter man må bruke.
Det fins ikke "BLE sockets" man bare kan pumpe full av data som om man snakket med en server over TCP.
Istedet opererer man med services og characteristics.

---
class: center

# Services

### En "service" er en samling data.
### F.eks. tempraturmåling fra termometer, hjerterytme fra pulsklokke etc.
### Hver "service" kan ha flere "characteristics"

---
class: center

# Characteristics

### Er 20-bytes variabler som aksesseres over BLE
### Kan tilby lesing, skriving, varsel m.m.
### Hjerterytmeservicen kan ha "heartrate" og "bodylocation" characteristics

---
class: center

# Eksempel fra puck-biblioteket

```cpp
const UUID SAMPLE_GATT_SERVICE =
  stringToUUID("my service uuid ");
const UUID SAMPLE_GATT_CHARACTERISTIC =
  stringToUUID("characteristiiic");

puck->addCharacteristic(
  SAMPLE_GATT_SERVICE,
  SAMPLE_GATT_CHARACTERISTIC,
  20,
  GattCharacteristic::
    BLE_GATT_CHAR_PROPERTIES_WRITE |
  GattCharacteristic::
    BLE_GATT_CHAR_PROPERTIES_READ);
```

---
class: center

# Print debugging

Skrive data fra mbed til PC-en

???

- Skriv via en `logger` i biblioteket vårt
- Må ha et program for å ta i mot dataen
- Se guiden vår på nettsida

---
class: center, middle

# Oppgave 2

---
class: center

# LF oppgave 2

```cpp
const UUID SAMPLE_GATT_SERVICE =
  stringToUUID("bftj sample     ");

const UUID SAMPLE_GATT_CHARACTERISTIC =
  stringToUUID("bftj sample char");
```

---
class: center

# LF oppgave 2

```cpp
puck->addCharacteristic(
  SAMPLE_GATT_SERVICE,
  SAMPLE_GATT_CHARACTERISTIC,
  20,
  GattCharacteristic::
    BLE_GATT_CHAR_PROPERTIES_WRITE |
  GattCharacteristic::
    BLE_GATT_CHAR_PROPERTIES_READ);
```

---
class: center

# LF oppgave 2

```cpp
// Bind handler
puck->onCharacteristicWrite(
  &SAMPLE_GATT_CHARACTERISTIC,
  onMessageReceived);

// Finalize puck
puck->init(0xFFFF);

// Hand over control to the BLE-stack
while(puck->drive());
```

---
class: center

# LF oppgave 2

```cpp
void onMessageReceived(
    const uint8_t* value,
    uint8_t length) {

  LOG_INFO(
    "Received message of %d bytes: %.*s\n",
    length, length, value);
}
```


---
class: center, middle

# SPOILER ALERT

Løsningsforslag for oppgave 2 følger

---
class: center, middle

# Oppgave 3

---
class: center, middle
# SPOILER ALERT

Løsningsforslag for oppgave 3 følger

---
class: center, middle

# Takk til

Hackerspace  

Rune Holmgren  

Nordic Semiconductor

???

- Tusen takk til Hackerspace for GPIO-sensorer

- Tusen takk til Rune Holmgren for lån av kamera

- Tusen takk til Nordic Semiconductor for donasjon av mbed-kort

---
class: center, middle

# Takk for oss


    </textarea>
    <script type="text/javascript">
      var slideshow = remark.create();
    </script>
  </body>
</html>
